# 100kb Chromatin Fiber Example

## Description

Complex chromatin fiber simulation with epigenetic modifications. This example simulates a 100 kilobase chromatin fiber with 519 nucleosomes, incorporating histone acetylation, linker histone H1 binding, and BRD4 association to study epigenetic-driven chromatin organization.

## Files

- `settings.input.json`: Fiber generation configuration for `nicg_define_fiber.py` script
- `reference.xyz`: Coarse-graining reference coordinates
- `in.bond_settings`: Bond parameters
- `in.relax`: Relaxation script for LAMMPS
- `in.run`: Production simulation script for LAMMPS
- `run.sh`: Complete workflow script
- `input_chain1.txt`: Nucleosome-by-nucleosome specification, generated by `nicg_define_fiber.py` script, input for chromatin builder
- `nucs.bed`: Nucleosome positions and states, generated by `nicg_define_fiber.py` script
- `settings.used.json`: Actual parameters used by `nicg_define_fiber.py` script
- `data.chromatin`: LAMMPS data file, generated by chromatin builder
- `chromatin.pdb`: 3D structure, generated by chromatin builder

## Simulation Details

- **System**: 519 nucleosomes (100 kb DNA)
- **Nucleosome types**: Canonical, acetylated, H1-bound, BRD4-associated
- **Box size**: 1600 × 1600 × 1600 Å³
- **Temperature**: 300 K
- **Salt concentration**: 150 mM
- **Epigenetic pattern**: Alternating 12.5 kb A/B compartments
- **Acetylation probability**: 40% (A) / 20% (B)
- **H1 binding probability**: 30% (A) / 60% (B)
- **BRD4 association**: 20% of acetylated nucleosomes
- **Ensemble**: NVT (Langevin thermostat)

## How to Run

```bash
# Complete workflow: generate fiber, build system, relax, and simulate
./run.sh
```

Or step by step:

```bash
# Generate chromatin fiber configuration
nicg_define_fiber.py --config settings.input.json

# Build system
nicg_chromatin_builder.py -f chains.txt -o chromatin.pdb -d data.chromatin -b in.bond_settings -hbox 800

# Run relaxation
lmp < in.relax

# Run production simulation
lmp < in.run
```
